---
title: Web 键盘输入法应用开发指南（一）
date: 2021-10-15 16:18:37
categories:
    - 技术
tags: 
    - 技术
    - 输入法
    - Web
    - JavaScript
---

## 介绍
在Web应用中，用户交互是十分基本和重要的功能，而来自用户的输入又离不开键盘。现代Web浏览器已经在底层对键盘做了**相对**较好的支持（逐渐就能看出为什么是“相对”），并通过API的方式暴露给开发者。这包括针对按键的事件捕获，不同语言键盘布局（Keyboard Layout）的支持，对输入法的支持（涉及中、日、韩等东亚语言），以及对不同平台（Windows、Mac、iOS等）上组合键的支持，等等。在这个系列的开头，我们来过一遍浏览器提供的这些与键盘输入相关的基本技术特性，先有一个基本印象，后续再逐渐展开。

## 按键事件
对于按键事件（Keyboard Event）[1]大家应该都不陌生，在开发Web应用时或多或少应该接触过。一般来说，这类事件是你在键盘上按下某个键时**最先触发**的事件。“最先”的意思是还有后续的事件类型产生（比如`input`事件等），用于进一步的输入逻辑处理。而到这一步，你（或者说Web应用)能知道的是，**浏览器从操作系统那里得到的按键信息**。至于说这个按键会得到怎样的输入和文本，那就是后续事件的事情了。我前面还加上了“**一般来说**”，这是因为不同的浏览器，针对不同的输入场景（是否使用输入法），还有不同的实现。

浏览器将按键事件分为三类：keydown、keyup 和 keypress，通过Keyboard Event对象的`type`属性来区分。前两类的含义可以从字面理解，而keypress类型一般是针对**产生具体字符**的按键（比如单按一个Ctrl键就不会产生字符），但已不推荐使用了[2]。有了这些类型，就可以在应用中对用户的键盘输入做比较精细的处理。一个简单的例子是，我要知道用户按住了某个特定的键，持续一段时间，以执行某个业务逻辑，并在释放按键时终止逻辑。

按键事件对象里还有一些常用的属性，比如`code`属性告诉你哪个键被按了，`location`属性告诉你这个键在键盘的哪个区域（是左Alt还是右Alt），`isCompsing`属性告诉你这个键是不是在使用输入法期间按下的，等等。当然，这些属性很多都有兼容性问题，我会在后面细说。

# 键盘布局


## 参考资料
- [1] Keyboard Event：https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent
- [2] https://developer.mozilla.org/en-US/docs/Web/API/Document/keypress_event